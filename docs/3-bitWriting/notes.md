# Bit Writing

## Process
- Primary location of the random bit files is entered.
- Location of the state/pointer file is entered.
- Simultaneous writing can be enabled.
- The amount of random bit files are entered.

- Progress lock file is generated to enable resuming of writing if the system is
interrupted.
- State/pointer file is created/read, (depending if is resume or not).
- - Contains state information as AD and key k2 as data, encrypted in AES-GCM. 
Key for AES-GCM is a password derived key k1.

- RDRand is used as keystream k1.
- Primary AES CTR mode keystream k2 is setup for random generation.
- Secondary CTR mode keystream k3 is setup for encryption of the random bits.
- -Key for secondary keystream is encrypted in AES-GCM with k2 and a in a 
keyfile.
- AES CTR mode keystreams are keyed from Quantis (if available) and /dev/random

- Random bits are generated by k1 XOR k2.
- k2 is rekeyed at an interval which won't effect performance too badly.
- Random bits are then encrypted by (k1 XOR k2) XOR k3.

